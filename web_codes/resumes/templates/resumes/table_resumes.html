{% extends "recruit_manager/table_basic.html" %}
{% load static %}
{% block content %}
<div class="table-responsive">
  <table class="table table-bordered" id="dataTable" width="100%" cellspacing="0" data-server-side="true" data-ajax="/api/resumes/?format=datatables">
    <thead>
      <tr>
        <th>CandidateID</th>
        <th>ID</th>
        <th>Name</th>
        <th>Gender</th>
        <th>Age</th>
        <th>Phone</th>
        <th>Email</th>
        <th>School</th>
        <th>Degree</th>
        <th>Major</th>
        <th>Stat</th>
      </tr>
    </thead>
  </table>
</div>
{% endblock %}

{% block extra_js %}
<script>
 $(document).ready(function() {
   var table = $('#dataTable').DataTable({
     "serverSide": true,
     "columns": [
       {"data": "candidate_id",
       visible: false},
       {"data": "resume_id"},
       {"data": "username"},
       {"data": "gender",
        render: function(cell, type, data, meta) {
          if (data.gender == 'f') {
            return "Female";
          }
          return "Male";
        }
       },
       {"data": "age"},
       {"data": "phone_number"},
       {"data": "email"},
       {"data": "school"},
       {"data": "degree"},
       {"data": "major"},
       {"data": "stat",
        render: function(data, type, row, meta) {
          console.log(row.stat);
          console.log(data, type, row, meta);
          if (row.stat) {
            return "\
<button class=\"btn btn-success btn-icon-split border-0\" id=\"stage\">\
<span class=\"icon text-white-50\">\
<i class=\"fas fa-check\"></i></span>\
<span class=\"text\">Interviewed</span>\
</button>";
          }

          if (row.candidate_id) {
            var url="{% url 'app_manager:t_interview_api' 1234 %}".replace(/1234/, row.candidate_id);

            var str = "\
<form action=" + url + " method='GET'>\
<button class=\"btn btn-info btn-icon-split border-0\" id=\"stage\">\
<span class=\"icon text-white-50\">\
<i class=\"fas fa-arrow-right\"></i></span>\
<span class=\"text\">Prepare Interview</span>\
</button>\
</form>";
            return str;
          }

          return "ABC";
        }
       },
     ],
   });
 });
</script>
{% endblock%}
